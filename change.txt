updated fig object
refactor (variable names,debug code)